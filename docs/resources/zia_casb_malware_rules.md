---
subcategory: "SaaS Security API"
layout: "zscaler"
page_title: "ZIA: casb_malware_rules"
description: |-
  Official documentation https://help.zscaler.com/zia/configuring-data-rest-scanning-malware-detection-policy
  API documentation https://help.zscaler.com/zia/saas-security-api#/casbMalwareRules-post
  Adds a new SaaS Security Data at Rest Scanning DLP rule
---

# zia_casb_malware_rules (Resource)

* [Official documentation](https://help.zscaler.com/zia/configuring-data-rest-scanning-malware-detection-policy)
* [API documentation](https://help.zscaler.com/zia/saas-security-api#/casbMalwareRules-post)

The **zia_casb_malware_rules** resource Adds a new SaaS Security Data at Rest Scanning Malware Detection rule.

## Example Usage

```hcl
data "zia_casb_tenant" "this" {
  tenant_name = "GitLab_Tenant01"
}

data "zia_rule_labels" "this" {
    name = "RuleLabel01
}

resource "zia_casb_malware_rules" "this" {
  name = "GitLab_Tenant01"
  action = "OFLCASB_AVP_REPORT_MALWARE"
  type = "OFLCASB_AVP_REPO"
  order = 1
  cloud_app_tenants {
    id = [data.zia_casb_tenant.this.id]
  }
  labels {
    id = [data.zia_rule_labels.this.id]
  }
  buckets {
    id = [1442271, 1442270, 1442268, 1442269, 1442272]
  }
}
```

## Schema

### Required

The following arguments are supported:

* `name` - (String) Rule name.
* `description` - (String) An admin editable text-based description of the rule.
* `order` - (Int) Order of rule execution with respect to other SaaS Security Data at Rest Scanning DLP rules.

* `type` - (String) The type of SaaS Security Data at Rest Scanning DLP rule. Supported values:
  * `ANY`,
  * `OFLCASB_AVP_FILE`
  * `OFLCASB_AVP_EMAIL`
  * `OFLCASB_AVP_CRM`
  * `OFLCASB_AVP_ITSM`
  * `OFLCASB_AVP_COLLAB`
  * `OFLCASB_AVP_REPO`
  * `OFLCASB_AVP_STORAGE`
  * `OFLCASB_AVP_GENAI`

* `action` - (String) The configured action for the policy rule
  * `OFLCASB_AVP_QUARANTINE`
  * `OFLCASB_AVP_REMOVE`
  * `OFLCASB_AVP_REPORT_MALWARE`
  * `OFLCASB_AVP_APPLY_EMAIL_TAG`
  * `OFLCASB_AVP_BLOCK`
  * `OFLCASB_AVP_ALLOW`

* `cloud_app_tenants` - (Block List) Cloud application tenants for which the rule is applied
  * `id` - (int) A unique identifier for an entity.

### Optional

* `state` - (String) Administrative state of the rule. Supported values: `ENABLED`, `DISABLED`. Defaults to `ENABLED`.
* `rank` - (Int) Admin rank that is assigned to this rule. Mandatory when admin rank-based access restriction is enabled.

* `quarantine_location` - (String) Location where all the quarantined files are moved and necessary actions are taken by either deleting or restoring the data

* `scan_inbound_email_link` - (String) Enables or disables the scan inbound email link. Supported Values:
  * `SCAN_EMAIL_LINK_ENABLE`
  * `SCAN_EMAIL_LINK_DISABLE`

* `labels` - (Block List) Name-ID pairs of rule labels associated with the rule.
  * `id` - (int) A unique identifier for an entity.

* `buckets` - (Block, Max: 1) The buckets for the Zscaler service to inspect for sensitive data
  * `id` - (int) A unique identifier for an entity.

* `casb_email_label` - (Block, Max: 1) The email label associated with the rule.
  * `id` - (int) A unique identifier for an entity.

* `casb_tombstone_template` - (Block, Max: 1) The quarantine tombstone template associated with the rule.
  * `id` - (int) A unique identifier for an entity.

## Import

Zscaler offers a dedicated tool called Zscaler-Terraformer to allow the automated import of ZIA configurations into Terraform-compliant HashiCorp Configuration Language.
[Visit](https://github.com/zscaler/zscaler-terraformer)

**zia_casb_malware_rules** can be imported by using `<RULE_TYPE:RULE_ID>` or `<RULE_TYPE:RULE_NAME>` as the import ID.

For example:

```shell
terraform import zia_casb_malware_rules.this <rule_type:rule_id>
```

```shell
terraform import zia_casb_malware_rules.this <"rule_type:rule_name">
```
